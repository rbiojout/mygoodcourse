<% @page_title = 'Checkout' %>


<script type="text/javascript">
    Stripe.setPublishableKey('<%= Rails.application.secrets.stripe_publishable_key %>');
</script>


<div class="row">

  <div class="col-xs-12 col-md-8">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Your order</h3>
      </div>
      <div class="panel-body">
          <div class="row">
            <div class="col-xs-12">
              <div id="order_items_index">
                <%= render(partial: "order_items/order_item", collection: current_order.order_items) %>
              </div>
            </div>
          </div>
      </div>
    </div>
  </div>




  <div class="col-xs-12 col-md-4">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><img class="pull-right" src="http://i76.imgup.net/accepted_c22e0.png">Payment Details</h3>
      </div>
      <div class="panel-body">
        <%= form_tag(checkout_confirmation_path, method: 'get', id:'stripe-form') do |f| %>
          <div class="row">
            <div class="col-xs-12">
              <span class="payment-errors"></span>
              <div class="form-group">
                <%= label_tag 'CARD NUMBER', nil, required: true %>
                <div class="input-group">
                  <input type="text" size="20" class="form-control cc-number" data-stripe="number" autocomplete="cc-number" placeholder="•••• •••• •••• ••••">
                  <span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-8 col-md-8">
              <div class="form-group">
                <%= label_tag 'EXPIRATION DATE', nil, required: true %><br>
                <div class="col-xs-6 col-lg-6 pl-ziro">
                  <%= select_month(Date.today, {use_two_digit_numbers: true},  class: 'form-control', data: {stripe: "exp-month"}) %>
                </div>
                <div class="col-xs-6 col-lg-6 pl-ziro">
                  <%= select_year(Date.today.year, {start_year: Date.today.year, end_year: Date.today.year + 10}, class: 'form-control', data: {stripe: "exp-year"}) %>
                </div>
              </div>
            </div>
            <div class="col-xs-4 col-md-4 pull-right">
              <div class="form-group">
                <%= label_tag 'CV CODE', nil, required: true %>
                <%= password_field_tag :cvCode, nil, :class=> "form-control", :placeholder=> "CV", "data-stripe" => "cvc"%>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              <div class="form-group">
                <label for="couponCode">COUPON CODE</label>
                <input type="text" class="form-control" name="couponCode" />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-xs-12">
              <%= submit_tag "Payment", class: "btn btn-success btn-lg btn-block" %>
            </div>
          </div>
          <div class="row" style="display:none;">
            <div class="col-xs-12">
              <p class="payment-errors"></p>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>




</div>




  <p>Secure connection</p>
  <h2>Place your order</h2>
  <p>Fantastic! You're ready to place your order, just follow the instructions below and
    we'll get your products shipped to you as quickly as we can.</p>
  <h3>Enter your payment informations</h3>
  <b>Card informations</b>
  <p>Card Number</p>
  <p>Expiration date</p>
  <p>Security code</p>



  .checkout
  %p.secure Secure connection
  %h3 Pay using your credit/debit card
  = form_for @order, :url => checkout_payment_path, :html => {:class => 'checkout'} do |f|
  = field_set_tag nil, :class => 'payment' do
  %h3 This is a demo form. Any values entered here will be accepted.
  %dl
  %dt= label_tag 'card_number', "Full Card Number"
  %dd.number= text_field_tag 'card_number', '', :name => nil
  %dl
  %dt= label_tag 'exp_month', "Expiry Date (mm/yyyy)"
  %dd.expiry
  = select_tag nil, options_for_select((1..12).to_a)
  = select_tag nil, options_for_select((Date.today.year..Date.today.year + 10).to_a), :class => 'year'
  %dl
  %dt= label_tag 'cvc', "Security Code"
  %dd.cvc
  = text_field_tag 'cvc', '', :name => nil, :maxlength => 4
  %span This is the 3 digit number on the back of your card.
  %p.submit= f.submit "Review your order", :class => 'review'



  <div id="orderitem-dropped">
  </div>

  <div id="order_items_index">
    <%= render(partial: "order_items/order_item", collection: current_order.order_items) %>
  </div>


  <h3>Complete your details below to complete your order</h3>

  <h4>Billing adress</h4>

  <h4>Card infos</h4>
  <h3>Pay using your credit/debit card</h3>


      <%= simple_form_for @order, :url => checkout_path, :html => {:class => 'checkout disableable'} do |f| %>
      <%= f.error_notification %>
        <%= f.button :submit  %>
      <% end %>
</div>

<div id="orderitem-modal" class="modal fade"></div>