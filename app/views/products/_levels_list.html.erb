<div class="panel-group" id="accordion_cycle" role="tablist" aria-multiselectable="true">
  <div class="panel panel-primary">
    <div class="panel-heading" role="tab" id="heading_cycle_0">
      <h2 class="panel-title">
        <%= (I18n.translate 'activerecord.models.level', count: 2).capitalize %>
      </h2>
    </div>
  </div>

  <% is_first= true %>
  <% country.cycles.each do |cycle| %>
      <% if cycle.levels.to_a.length > 0  %>
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="heading_cycle_<%=cycle.id%>">
                <h2 class="panel-title">
                  <a role="button" data-toggle="collapse"  data-parent="#accordion_cycle" href="#collapse_cycle_<%=cycle.id%>" aria-expanded="<%=(is_first==true)? 'true':'false'%>" aria-controls="collapse_cycle_<%=cycle.id%>">
                    <i class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></i> <%=cycle.name%>
                  </a>
                </h2>
              </div>
              <div id="collapse_cycle_<%=cycle.id%>" class="panel-collapse collapse <%='in' if(is_first==true) %>" role="tabpanel" aria-labelledby="heading_cycle_<%=cycle.id%>">
                <div class="panel-body">
                  <%= f.association :levels, label: false, collection: cycle.levels, as: :check_boxes %>
                </div>
              </div>
            </div>
      <% end %>
      <% is_first = false %>
  <% end %>
  <% f.association :levels, collection: Cycle.all, as: :grouped_select, group_method: :levels %>

</div>