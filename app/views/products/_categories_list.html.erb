<div class="row panel-group" id="accordion" role="tablist" aria-multiselectable="true">

  <% Family.all.each do |family| %>
      <% if family.categories.to_a.length > 0  %>
          <div class="col-sm-4 col-md-3">
            <div class="panel panel-default">
              <div class="panel-heading" role="tab" id="heading<%=family.id%>">
                <h4 class="panel-title">
                  <a role="button" data-toggle="collapse"  data-parent="#accordion" href="#collapse<%=family.id%>" aria-expanded="false" aria-controls="collapse<%=family.id%>">
                    <i class="glyphicon glyphicon-triangle-bottom" aria-hidden="true"></i> <%=family.name%>
                  </a>
                </h4>
              </div>
              <div id="collapse<%=family.id%>" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading<%=family.id%>">
                <div class="panel-body">
                  <%= f.association :categories, label: family.name, collection: family.categories, as: :check_boxes %>
                </div>
              </div>
            </div>
          </div>
      <% end %>
  <% end %>
  <% f.association :categories, collection: Family.all, as: :grouped_select, group_method: :categories %>

</div>